# Application Configuration
spring:
  application:
    name: ai-text-summarizer
  profiles:
    active: dev

# Server Configuration
server:
  port: 8080
  servlet:
    context-path: /

# AI Configuration
spring.ai:
  openai:
    api-key: ${OPENAI_API_KEY}
    chat:
      options:
        model: gpt-4o-mini
        temperature: 0.3

# Custom AI Summarizer Properties
ai:
  summarizer:
    model: gpt-4o-mini
    temperature: 0.3
    max-tokens: 500
    timeout: 30s
    max-input-length: 10000
    retry:
      max-attempts: 3
      backoff: 2s

# Resilience4j Configuration
resilience4j:
  # Rate Limiter Configuration
  ratelimiter:
    instances:
      summarizeApi:
        limit-for-period: 10
        limit-refresh-period: 1m
        timeout-duration: 5s
        register-health-indicator: true
        event-consumer-buffer-size: 100

  # Retry Configuration - simplified for test compatibility
  retry:
    instances:
      summarizeService:
        max-attempts: 3
        wait-duration: 1s
        retry-exceptions:
          - java.lang.Exception
        ignore-exceptions:
          - com.azharkhalid.aitextsummarizer.exception.InvalidInputException
        register-health-indicator: true

  # TimeLimiter Configuration
  timelimiter:
    instances:
      summarizeService:
        timeout-duration: 30s
        cancel-running-future: true
        register-health-indicator: true

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
      base-path: /actuator
  endpoint:
    health:
      show-details: always
      show-components: always
    metrics:
      enabled: true
    prometheus:
      enabled: true
  metrics:
    export:
      prometheus:
        enabled: true
        step: 1m
        descriptions: true
    tags:
      application: ${spring.application.name}
      environment: ${spring.profiles.active:default}
    distribution:
      percentiles-histogram:
        summarize.request.duration: true
      percentiles:
        summarize.request.duration: 0.5,0.95,0.99
      sla:
        summarize.request.duration: 100ms,500ms,1s,2s,5s
  health:
    defaults:
      enabled: true
    diskspace:
      enabled: true
    redis:
      enabled: false
    db:
      enabled: false

# Logging Configuration
logging:
  level:
    com.azharkhalid.aitextsummarizer: INFO
    org.springframework.ai: DEBUG
    io.github.resilience4j: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
